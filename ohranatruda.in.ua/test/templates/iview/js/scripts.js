/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

	eval("\"use strict\";\n\n/*mousewhell*/\n\n//Проверяет, загржены ли изображения в блоке\n\n//dot-dot-dot\n\n//touch for smartphoenes\n\nvar fragment;\nvar upload_image_currXhr = null;\nvar upload_image_crop = false;\nvar newPoll_refreshNewPollTime;\nvar newArticle_refreshNewArticleTime;\nvar wysiwyg = [];\nvar newPoll_last_click = false;\nvar newArticle_last_click = false;\nvar newPoll_gridster_li_move = false;\nvar newPoll_gridster;\nvar newPoll_gridsterTimer;\nvar newPoll_gridster_move_time = false;\nvar newPoll_gridster_move_time_start = false;\nvar googleMapEnabled = false;\nvar googleMapEnabledTimer = false;\nvar googleMapSelectTimer = false;\nvar feedback_timer = false;\nvar viewImageTimer;\nvar initMasonryInstance = false;\nvar paginated_ajax_load = false;\n\njQuery(document).ready(function () {\n    //Ajax pagination =============================================================================\n    var window_height = $(window).height();\n    $(document).scroll(function () {\n        if ($(\".paginated_ajax\").length) {\n            $(\".paginated\").remove();\n            /*var paginated_ajax_top = $(\".paginated_ajax\").offset().top;\r\n             if(($(\"body\").scrollTop() + 2*window_height) > paginated_ajax_top){\r\n             if (!paginated_ajax_load) $(\".paginated_ajax\").click();\r\n             paginated_ajax_load = true;\r\n             }*/\n        }\n    });\n    //=============================================================================================\n\n    //Google Map init =============================================================================\n    if ($(\".googleMap\").length) {\n        google.load(\"visualization\", \"1\", { packages: [\"geochart\"], \"callback\": initGoogleMap });\n    }\n    //=============================================================================================\n\n    $(\"body\").on(\"click\", \"a[href='#']\", function (e) {\n        e.preventDefault();\n    });\n\n    //Лимит длины для textarea\n    $('textarea[maxlength]').keyup(function () {\n        var limit = parseInt($(this).attr('maxlength'));\n        var text = $(this).val();\n        var chars = text.length;\n        if (chars > limit) {\n            var new_text = text.substr(0, limit);\n            $(this).val(new_text);\n        }\n    });\n\n    $(\".modal-wide\").on(\"show.bs.modal\", function () {\n        var height = $(window).height() - 200;\n        $(this).find(\".modal-body\").css(\"max-height\", height);\n    });\n\n    //Для всех кнопок с прелоадером\n    $(\"body\").on(\"click\", \".btn.btn-preloader\", function () {\n        $(this).addClass(\"wait\");\n    });\n\n    //Просмотр новости из БД\n    $(\".news[data-source='bd']\").click(function () {\n        var id = $(this).attr('data-id');\n        $(\"#news_view_from_bd .apply\").prop(\"disabled\", true);\n        $(\"#news_view_from_bd .modal-body\").html(\"<div style='text-align:center; margin:10px; font-size:11pt;'>Идет загрузка...</div>\");\n        $(\"#news_view_from_bd\").modal();\n        $.ajax({\n            url: \"/udata/news/getNewsMysql/\" + id + \"/?transform=modules/news/get_news_mysql_ajax.xsl\",\n            type: \"POST\",\n            dataType: 'html',\n            success: function success(data) {\n                $(\"#news_view_from_bd .apply\").prop(\"disabled\", false);\n                $(\"#news_view_from_bd .modal-body\").html(data);\n            }\n        });\n    });\n\n    //Форма авторизации / регистрации =============================================================\n    if ($(\"#authorization\").length) {\n        $(\"#authorization\").on(\"click\", \".next_p\", function () {\n            $(\"#authorization .preloader\").removeClass(\"hide\");\n            var inset = $(\"#authorization .inset:not(.hide)\").attr(\"inset\");\n            if (inset == undefined) return false;\n            var func = \"\";\n\n            switch (inset) {\n                case \"1\":\n                    func = \"authorization\";break;\n                case \"2\":\n                    func = \"registration\";break;\n            }\n            if (func != \"\") {\n                $.ajax({\n                    url: \"/udata/users/\" + func + \"/.json\",\n                    type: \"POST\",\n                    dataType: 'json',\n                    data: $(\"#authorization form\").serialize(),\n                    success: function success(data) {\n                        $(\"#authorization .preloader\").addClass(\"hide\");\n                        var result = data.result;\n                        var set_inset = data.set_inset;\n                        var loc = data.location;\n                        $(\"#authorization .alert-warning\").addClass(\"hide\");\n                        if (result != undefined && result != \"success\") {\n                            $(\"#authorization .alert-warning[warning='\" + result + \"']\").removeClass(\"hide\");\n                        } else {\n                            $(\"#authorization .avatar_mail\").html($(\"#authorization input[name='email']\").val());\n                            $(\"#authorization .avatar_mail\").val($(\"#authorization input[name='email']\").val());\n                            if (set_inset != undefined) {\n                                if (set_inset == \"location\") {\n                                    if (loc != undefined) {\n                                        if (loc == \"reload\") location.reload();else location.href = loc;\n                                    }\n                                } else {\n                                    $(\"#authorization .alert-warning\").addClass(\"hide\");\n                                    $(\"#authorization .inset\").addClass(\"hide\");\n                                    $(\"#authorization .inset[inset='\" + set_inset + \"']\").removeClass(\"hide\");\n                                }\n                            }\n                        }\n                    }\n                });\n            }\n        });\n        $(\"#authorization\").on(\"click\", \".set_inset\", function (e) {\n            e.preventDefault();\n            var set_inset = $(this).attr(\"inset\");\n            if (set_inset != undefined) {\n                $(\"#authorization .inset\").addClass(\"hide\");\n                $(\"#authorization .inset[inset='\" + set_inset + \"']\").removeClass(\"hide\");\n                $(\"#authorization .alert-warning\").addClass(\"hide\");\n            }\n        });\n        $(\"#authorization\").on(\"keyup\", \"input\", function (i) {\n            if (i.keyCode != undefined) if (i.keyCode == 13) $(\"#authorization .next_p\").click();\n        });\n        $(\"#authorization\").on(\"click\", \".remind_password\", function () {\n            $(\"#authorization .preloader\").removeClass(\"hide\");\n            $.ajax({\n                url: \"/udata/users/remindPassword/.json\",\n                type: \"POST\",\n                dataType: 'json',\n                data: $(\"#authorization form\").serialize(),\n                success: function success(data) {\n                    $(\"#authorization .preloader\").addClass(\"hide\");\n                    var result = data.result;\n                    $(\"#authorization .alert-warning\").addClass(\"hide\");\n                    if (result != undefined && result != \"success\") {\n                        $(\"#authorization .alert-warning[warning='\" + result + \"']\").removeClass(\"hide\");\n                    } else {\n                        $(\"#authorization .inset\").addClass(\"hide\");\n                        $(\"#authorization .inset[inset='3']\").removeClass(\"hide\");\n                        $(\"#authorization .next_p\").addClass(\"hide\");\n                    }\n                }\n            });\n        });\n        $(\"#authorization\").on('hide.bs.modal', function (e) {\n            setTimeout(function () {\n                $(\"#authorization .inset\").addClass(\"hide\");\n                $(\"#authorization .inset[inset='1']\").removeClass(\"hide\");\n                $(\"#authorization .next_p\").removeClass(\"hide\");\n                $(\"#authorization .alert-warning\").addClass(\"hide\");\n                $(\".save_poll\").prop(\"disabled\", false);\n            }, 300);\n        });\n        //=============================================================================================\n    }\n\n    //Голосование. Нажатие на кнопку \"Голосовать\"\n    $(\"body\").on(\"click\", \".poll .vote\", function () {\n        this_ = $(this);\n        var needreg = this_.attr(\"data-needreg\");\n        if (needreg != undefined) {\n            $(\"#authorization\").modal();\n            return false;\n        }\n        var poll = this_.closest(\".poll\");\n        var id = poll.attr(\"data-id\");\n        this_.prop(\"disabled\", true);\n        this_.find(\"span\").addClass(\"hide\");\n        this_.find(\".preloader\").removeClass(\"hide\");\n        $.ajax({\n            url: \"/udata/vote/votePoll/?transform=modules/vote/vote_poll.xsl\",\n            type: \"POST\",\n            dataType: 'html',\n            data: poll.find('form').serialize(),\n            success: function success(data) {\n                if (data.indexOf(\"Failed to open udata\") != -1) $(\"#unexpected_error\").modal();\n                var clone_id = \"poll\" + id + \"_clone\";\n                poll.append(\"<div id='\" + clone_id + \"'></div>\");\n                poll.find(\"#\" + clone_id).html(data);\n                $(\".poll.poll\" + id).html(poll.find(\"#\" + clone_id + \" .poll\" + id).html());\n                initCutContent();\n                poll.find(\"#\" + clone_id).remove();\n                initMasonry();\n                initPlayVideoIcon();\n                initColorBox();\n                drawGoogleMaps();\n            }\n        });\n    });\n\n    //Проверка капчи\n    $(\"#captcha_enter .apply\").on(\"click\", function () {\n        this_ = $(this);\n        this_.addClass(\"wait\");\n        $.ajax({\n            url: \"/udata/content/checkCaptcha/.json\",\n            type: \"POST\",\n            dataType: 'json',\n            data: { captcha: $(\"input#captcha\").val() },\n            success: function success(data) {\n                if (data.result != undefined) if (data.result == \"1\") {\n                    $(\"#captcha_enter\").modal('hide');\n                    $(\"[data-captcha = '1']\").each(function () {\n                        $(this).removeAttr(\"data-captcha\");\n                        $(this).unbind();\n                    });\n                    $(\"[data-send='1']\").click();\n                } else {\n                    $(\"#captcha_reset\").click();\n                }\n                this_.removeClass(\"wait\");\n            }\n        });\n    });\n\n    //Вывод всех категорий\n    $(\"#navigation\").on(\"click\", \".all_categories\", function () {\n        var open = $(this).attr(\"data-open\");\n        if (open == \"0\") {\n            $(\"#navigation #all_catagories\").slideDown(\"fast\", function () {\n                $(\".grid-item\").fadeIn(\"fast\");\n                initMasonry();\n            });\n            $(this).attr(\"data-open\", \"1\");\n            $(\"li.all_categories\").addClass(\"active\");\n        } else {\n            $(\"#navigation #all_catagories\").slideUp(\"fast\");\n            $(this).attr(\"data-open\", \"0\");\n            $(\"li.all_categories\").removeClass(\"active\");\n        }\n    });\n\n    //homepage =========================================================================================================\n    //homepage =========================================================================================================\n    if ($(\"#homepage\").length) {\n        $(\".popular_categories img\").hover(function () {\n            $(this).stop().animate({ width: \"160px\", marginTop: \"0px\" }, 100);\n        }, function () {\n            $(this).stop().animate({ width: \"150px\", marginTop: \"5px\" }, 100);\n        });\n    }\n    //homepage =========================================================================================================\n\n\n    //NewPoll ==========================================================================================================\n    if ($(\".new_poll_block\").length) {\n\n        refreshNewPoll(false, true);\n\n        $(\"body\").on(\"change\", \".new_poll_block #new_poll_form select, .new_poll_block #new_poll_form input:not(.poll .variants input), .new_poll_block #new_poll_form textarea\", function () {\n            if ($(this).attr('name') == 'data[country]') {\n                $(\"select[name='data[region]\").val('');\n                $(\"select[name='data[city]\").val('');\n            }\n            if ($(this).attr('name') == 'data[region]') {\n                $(\"select[name='data[city]\").val('');\n            }\n            refreshNewPoll(true, $(this).attr(\"reload_form\") != undefined ? true : false);\n        });\n\n        //Сохранение нового опроса\n        $(\"body\").on(\"click\", \".save_poll\", function () {\n            $(\".new_poll_block .save_poll\").html(\"Сохранение...\");\n            $(\".new_poll_block .save_poll\").prop(\"disabled\", true);\n\n            var data_type = $(\".new_poll_block\").attr(\"data-type\");\n            var data_for = $(\".new_poll_block\").attr(\"data-for\");\n            data_for = data_for != undefined ? data_for : \"\";\n            var data_id = $(\".new_poll_block\").attr(\"data-id\");\n            data_id = data_id != undefined ? data_id : \"\";\n\n            var fast = data_type == \"fast\" ? \"1/\" : \"\";\n\n            if (newPoll_refreshNewPollTime === false) {\n                $.ajax({\n                    url: \"/udata/vote/saveNewPoll/\" + fast + \".json\",\n                    type: \"POST\",\n                    dataType: 'json',\n                    data: $(\".new_poll_block #new_poll_form\").serialize(),\n                    success: function success(data) {\n                        if (data.error != undefined) {\n                            $(\".new_poll_block .save_poll\").prop(\"disabled\", false);\n                            switch (data.error) {\n                                case \"not_auth\":\n                                    $(\"#authorization\").modal();\n                                    return false;\n                                    break;\n                                case \"not_enough_data\":\n                                    $(\"#not_enough_data_poll\").modal();\n                                    return false;\n                                    break;\n                                case \"images_incorrect\":\n                                    $(\"#images_incorrect\").modal();\n                                    return false;\n                                    break;\n                                case \"homepage\":\n                                    location.href = \"/\";\n                                    return false;\n                                    break;\n                            }\n                        }\n                        if (data.fast != undefined) {\n                            $(\"#fast_poll_complete\").modal();\n                            refreshNewPoll(false, true);\n                            return false;\n                        } else {\n                            if (data.url != undefined) {\n                                location.href = data.url;\n                            } else location.href = \"/cabinet/\";\n                        }\n                    }\n                });\n            } else newPoll_last_click = \".save_poll\";\n        });\n        $('body').on('hide.bs.modal', '#not_enough_data_poll', function (e) {\n            $(\".new_poll_block .save_poll\").html(\"Сохранить опрос\");\n        });\n        $('body').on('hide.bs.modal', '#authorization', function (e) {\n            $(\".new_poll_block .save_poll\").html(\"Сохранить опрос\");\n        });\n        $('body').on('hide.bs.modal', '#images_incorrect', function (e) {\n            $(\".new_poll_block .save_poll\").html(\"Сохранить опрос\");\n        });\n    }\n    //NewPoll ==========================================================================================================\n\n\n    //NewArticle =======================================================================================================\n    //NewArticle =======================================================================================================\n    if ($(\"#new_article\").length) {\n        refreshNewArticle(false, true);\n\n        $(\"body\").on(\"change\", \"#new_article #new_article_form select, #new_article #new_article_form input\", function () {\n            refreshNewArticle(true, $(this).attr(\"reload_form\") != undefined ? true : false);\n        });\n\n        setInterval(function () {\n\n            $(\".wysiwyg\").each(function () {\n                var id = $(this).attr(\"id\");\n                if (CKEDITOR.instances[id].getData() != wysiwyg[id]) {\n                    wysiwyg[id] = CKEDITOR.instances[id].getData();\n                    $(\"input[type='hidden'][data-for='\" + id + \"']\").val(wysiwyg[id]);\n                    refreshNewArticle(true, false);\n                }\n            });\n        }, 10000);\n\n        //Уадаление изображения\n        $(\"body\").on(\"click\", \"#new_article .remove\", function () {\n            $.ajax({\n                url: \"/udata/content/newArticleRemovePhoto/\",\n                type: \"POST\",\n                dataType: 'html',\n                success: function success(data) {\n                    refreshNewArticle(false, true);\n                }\n            });\n        });\n\n        //Сохранение новой статьи\n        $(\"body\").on(\"click\", \".save_article\", function () {\n            $(\"#new_article .save_article\").html(\"Сохранение...\");\n            $(\"#new_article .save_article\").prop(\"disabled\", true);\n\n            $(\".wysiwyg\").each(function () {\n                var id = $(this).attr(\"id\");\n                wysiwyg[id] = CKEDITOR.instances[id].getData();\n                $(\"input[type='hidden'][data-for='\" + id + \"']\").val(wysiwyg[id]);\n            });\n\n            if (newArticle_refreshNewArticleTime === false) {\n                $.ajax({\n                    url: \"/udata/content/saveNewArticle/.json\",\n                    type: \"POST\",\n                    dataType: 'json',\n                    data: $(\"#new_article #new_article_form\").serialize(),\n                    success: function success(data) {\n                        if (data.error != undefined) {\n                            switch (data.error) {\n                                case \"not_auth\":\n                                    $(\"#authorization\").modal();\n                                    return false;\n                                    break;\n                                case \"not_enough_data\":\n                                    $(\"#new_article #not_enough_data\").modal();\n                                    return false;\n                                    break;\n                                case \"homepage\":\n                                    location.href = \"/\";\n                                    return false;\n                                    break;\n                            }\n                            $(\"#new_article .save_article\").prop(\"disabled\", false);\n                        }\n                        if (data.url != undefined) {\n                            location.href = data.url;\n                        } else location.href = \"/cabinet/\";\n                    }\n                });\n            } else newArticle_last_click = \".save_article\";\n        });\n        $('body').on('hide.bs.modal', '#new_article #not_enough_data', function (e) {\n            $(\"#new_article .save_article\").html(\"Сохранить статью\");\n        });\n        $('body').on('hide.bs.modal', '#authorization', function (e) {\n            $(\"#new_article .save_article\").html(\"Сохранить статью\");\n        });\n    }\n    //NewArticle =======================================================================================================\n\n\n    //Cabinet ==========================================================================================================\n    //Cabinet ==========================================================================================================\n    if ($(\"#cabinet\").length) {\n        if ($(\"#cabinet_profile\").length) {\n            cabinet_profile();\n        }\n    }\n    //Cabinet ==========================================================================================================\n\n    //Feed =============================================================================================================\n    $(\".feed .feed-info .subsribe button:not(.disabled)\").on(\"click\", function () {\n        if (!$(this).hasClass(\"no-auth\")) {\n            feedSubscribe($(this));\n        }\n    });\n\n    if ($(\"#feeds_setting_form\").length) {\n        initWysiwyg();\n\n        var feedId = $(\"#feeds_setting_form\").attr(\"data-feed-id\");\n        setTimeout(function () {\n            $(\"#feeds_setting_form\").cc_validate({\n                settings: { required_class: 'required', error_class: 'error' },\n                rules: [{ element: \"input[name='name']\", rule: 'min_length', min_length: 5 }, { element: \"input[name='url']\", rule: 'check', url: '/vote/checkUrlLent/' + feedId + '/?url=', need: 'true' }],\n                warning: function warning(elem, rule, result) {\n                    switch (result) {\n                        case 'error':\n                            elem.closest('div').find('span[data-warning=' + rule + ']').html(\"Недопустимый формат\");\n                            break;\n                        case 'exist':\n                            elem.closest('div').find('span[data-warning=' + rule + ']').html(\"Адрес уже занят\");\n                            break;\n                        case 'url_short':\n                            elem.closest('div').find('span[data-warning=' + rule + ']').html(\"Слишком короткий адрес\");\n                            break;\n                    }\n                    elem.closest('div').find('span[data-warning=' + rule + ']').removeClass('hide');\n                    setTimeout(function () {\n                        $(\"#feeds_setting_form button[type='submit']\").removeClass(\"wait\");\n                    }, 300);\n                },\n                hide_warning: function hide_warning(elem, rule, result) {\n                    elem.closest('div').find('span[data-warning=' + rule + ']').addClass('hide');\n                },\n                success: function success(form) {\n                    var feed_description = CKEDITOR.instances.feed_description.getData();\n                    $(\"#feed_description_hidden\").val(feed_description);\n                    form.submit();\n                }\n            });\n        }, 500);\n    }\n    //Feed =============================================================================================================\n\n    //Feedback =========================================================================================================\n    $(\"#feedback_form\").cc_validate({\n        settings: { required_class: 'required', error_class: 'error' },\n        rules: [],\n        warning: function warning(elem, rule, result) {\n            if (feedback_timer === false) feedback_timer = setTimeout(function () {\n                $(\"#feedback .btn-preloader\").removeClass(\"wait\");\n                feedback_timer = false;\n            }, 300);\n        },\n        hide_warning: function hide_warning(elem, rule, result) {\n            if (feedback_timer === false) feedback_timer = setTimeout(function () {\n                $(\"#feedback .btn-preloader\").removeClass(\"wait\");\n                feedback_timer = false;\n            }, 300);\n        },\n        success: function success(form) {\n            if (feedback_timer !== false) clearTimeout(feedback_timer);\n            $(\"#feedback .btn-preloader\").addClass(\"wait\");\n            $.ajax({\n                url: \"/udata/feedback/send/.json\",\n                type: \"POST\",\n                dataType: 'json',\n                data: $(\"#feedback_form\").serialize(),\n                success: function success(data) {\n                    if (data.result != undefined) {\n                        if (data.result == 'true') {\n                            $(\"#feedback\").modal(\"hide\");\n                            $(\"#feedback .btn-preloader\").removeClass(\"wait\");\n                            setTimeout(function () {\n                                $(\"#feedback input[type='text'], #feedback textarea\").val(\"\");\n                                $(\"#feedback_success\").modal();\n                            }, 300);\n                            return false;\n                        }\n                    }\n                    $(\"#feedback .alert\").removeClass(\"hide\");\n                    $(\"#feedback .btn-preloader\").removeClass(\"wait\");\n                }\n            });\n            return false;\n        }\n    });\n    //Feedback =========================================================================================================\n\n    //view_category ====================================================================================================\n    if ($(\"#view_category\").length) {}\n    //view_category ====================================================================================================\n\n    init_counter();\n    initColorBox();\n    initTooltips();\n    initComments();\n    initCaptcha();\n    initSetInfo();\n    initCropper();\n    initIntroJs();\n\n    $(window).load(function () {\n        $(\".hidden_block\").removeClass(\"hidden_block\");\n        adaptiveImage();\n        init_dot();\n        initCutContent();\n        initMasonry();\n        goto();\n        initPlayVideoIcon();\n    });\n    if (googleMapEnabled) drawGoogleMaps();else {\n        googleMapEnabledTimer = setInterval(function () {\n            if (googleMapEnabled) {\n                clearInterval(googleMapEnabledTimer);\n                drawGoogleMaps();\n            }\n        }, 500);\n    }\n\n    //Для открывающихся текстов\n    $(\"body\").on(\"click\", \".slidedown_title\", function () {\n        var id = $(this).attr(\"data-for-content\");\n        $(this).toggleClass(\"dropup\");\n        $(\".slidedown_content[data-id='\" + id + \"']\").toggleClass(\"hide\");\n        if ($(this).hasClass(\"dropup\")) $.cookie('alert_slidedown_' + id, null, { path: '/' });else $.cookie('alert_slidedown_' + id, 1, { path: '/' });\n    });\n    openAlerts();\n\n    //Если установлен get параметр preview, выполняется click по .popup_img с соответств. id\n    $(\".popup_img[data-id='\" + $(\"#service-information\").attr(\"data-preview\") + \"']\").click();\n\n    //Ajax пагинация\n    $(\"body\").on(\"click\", \".paginated_ajax\", function () {\n        var this_ = $(this);\n        var block = this_.attr(\"for-data-block\");\n        var udata = this_.attr(\"data-udata\");\n        var transform = this_.attr(\"data-transform\");\n        var page = this_.attr(\"data-page\");\n        var search_string = this_.attr(\"data-search_string\");\n\n        page = page !== undefined ? parseInt(page) + 1 : 1;\n        this_.attr(\"data-page\", page);\n        $.ajax({\n            url: udata + \"?transform=\" + transform,\n            type: \"POST\",\n            dataType: 'html',\n            data: { p: page, search_string: search_string },\n            success: function success(data) {\n                var parsedHtml = $.parseHTML(data);\n\n                $(\"[data-block='\" + block + \"']\").append(data);\n\n                var selector = \"\";\n                var first = true;\n\n                for (var i = 0; i < parsedHtml.length; i++) {\n                    if (parsedHtml[i].nodeName == \"DIV\") if (parsedHtml[i].hasAttribute(\"data-id\")) {\n                        var pollId = parsedHtml[i].getAttribute(\"data-id\");\n                        if (pollId) {\n                            if (!first) selector += \",\";\n                            selector += \".poll.poll\" + pollId;\n                            first = false;\n                        }\n                    }\n                }\n\n                $(selector).css(\"opacity\", \"0.01\");\n\n                $(\"[data-block='\" + block + \"']\").waitForImages(function () {\n                    initCutContent();\n                    initComments();\n                    initMasonry();\n                    initCaptcha();\n                    initPlayVideoIcon();\n                    if ($(\"[data-block='\" + block + \"'] .last_page\").length) {\n                        this_.remove();\n                        $(\"[data-block='\" + block + \"'] .last_page\").remove();\n                    } else this_.removeClass('wait');\n\n                    $(selector).animate({ opacity: 1.0 }, 300, function () {\n                        paginated_ajax_load = false;\n                    });\n                });\n            }\n        });\n    });\n\n    $(\".swipe-area\").swipe({\n        swipeStatus: function swipeStatus(event, phase, direction, distance, duration, fingers) {\n            if (phase == \"move\" && direction == \"right\") {\n                $(\"#left_panel\").animate({ left: '0px' }, 200, function () {\n                    $(\"#left_panel\").addClass(\"opened\");\n                });\n                return false;\n            }\n            if (phase == \"move\" && direction == \"left\") {\n                $(\"#left_panel\").animate({ left: '-220px' }, 200, function () {\n                    $(\"#left_panel\").removeClass(\"opened\");\n                });\n                return false;\n            }\n        }\n    });\n    $(\"#open_sidebar\").click(function () {\n        if ($(\"#left_panel\").hasClass(\"opened\")) {\n            $(\"#left_panel\").animate({ left: '-220px' }, 200, function () {\n                $(\"#left_panel\").removeClass(\"opened\");\n            });\n        } else {\n            $(\"#left_panel\").animate({ left: '0px' }, 200, function () {\n                $(\"#left_panel\").addClass(\"opened\");\n            });\n        }\n    });\n});\n\nfunction initColorBox() {\n    $('a.popup_img:not(.video)').colorbox({\n        current: \"{current} из {total}\"\n    });\n    $('a.popup_img.video').colorbox({ iframe: true, innerWidth: 640, innerHeight: 390 });\n}\n\nfunction initTooltips() {\n    $(function () {\n        $('[data-toggle=\"tooltip\"]').tooltip();\n    });\n}\n\n//Создает элементы option\nfunction init_counter() {\n    $(\"body\").find(\"option[data-counter_from]\").each(function () {\n        var from = parseInt($(this).attr(\"data-counter_from\"));\n        var to = parseInt($(this).attr(\"data-counter_to\"));\n        var this_ = $(this);\n        var selected = this_.closest(\"select\").attr(\"data-select\") != undefined ? parseInt(this_.closest(\"select\").attr(\"data-select\")) : false;\n        this_.removeAttr(\"data-counter_from\");\n        this_.removeAttr(\"data-counter_to\");\n        this_.attr(\"value\", from);\n        this_.text(from);\n        for (index = from + 1; index <= to; index++) {\n            var clone = this_.clone();\n            clone.attr(\"value\", index);\n            clone.text(index);\n            if (selected !== false) if (index == selected) clone.attr(\"selected\", \"selected\");\n            this_.closest(\"select\").append(clone);\n        }\n        $(this).closest('select').find(\"[data-remove='1']\").remove();\n    });\n}\n\n//Комментарии\nfunction initComments() {\n    $(\".comment\").each(function () {\n        var c = $(this);\n        var ta = c.children(\"textarea\");\n        ta.focus(function () {\n            ta.stop().animate({ height: \"75px\" }, 250);\n        });\n        ta.blur(function () {\n            if (ta.val() == '') ta.stop().animate({ height: \"50px\" }, 250);\n        });\n    });\n\n    //Если количество блоков .comment.float больше 1, удаляем лишние\n    $(\".comment.float\").each(function (i) {\n        if (i > 0) $(this).remove();\n    });\n\n    $(\"body\").on(\"click\", \".comment_this\", function () {\n        var this_ = $(this);\n        if (this_.attr(\"data-opened\") == undefined) {\n            $(\".comment_this\").removeAttr(\"data-opened\");\n            this_.attr(\"data-opened\", \"1\");\n            $(\".comment.float\").slideUp(\"fast\", function () {\n                this_.closest(\".comment_content\").children(\".answer\").append($(\".comment.float\"));\n                $(\".comment.float input,.comment.float textarea\").val('');\n                $(\".comment.float\").slideDown(\"fast\", function () {\n                    setTimeout(function () {\n                        initMasonry();\n                    }, 200);\n                });\n                $(\".comment.float\").attr(\"data-parent\", this_.attr('data-parent'));\n                $(\".comment.float\").attr(\"data-page\", this_.attr('data-page'));\n                $(\".comment.float\").attr(\"data-per_page\", this_.attr('data-per_page'));\n                $(\".comment_this\").removeClass('hide');\n                $(\".cancel_comment_this\").addClass('hide');\n                this_.addClass('hide');\n                this_.closest(\".comment_content\").children(\".cancel_comment_this\").removeClass(\"hide\");\n            });\n        }\n    });\n    $(\"body\").on(\"click\", \".cancel_comment_this\", function () {\n        $(\".comment.float\").slideUp(\"fast\", function () {\n            setTimeout(function () {\n                initMasonry();\n            }, 200);\n        });\n        $(this).addClass(\"hide\");\n        $(this).closest(\".comment_content\").children(\".comment_this\").removeClass(\"hide\");\n        $(\".comment_this\").removeAttr(\"data-opened\");\n    });\n}\n\n//Инициализация капчи\nfunction initCaptcha() {\n    $(\"[data-captcha = '1']\").each(function () {\n        $(this).click(function () {\n            $(\"#captcha_enter\").modal();\n            $('#captcha_enter').on('shown.bs.modal', function (e) {\n                $(\"#captcha\").focus();\n            });\n        });\n    });\n}\n\n//Отправка комментария\nfunction sendComment(elem) {\n    var comment = elem.closest(\".comment\");\n    var objId = comment.attr(\"data-page\");\n    var parentId = comment.attr(\"data-parent\");\n    var per_page = comment.attr(\"data-per_page\");\n    var content = comment.find(\"textarea\").val();\n    var anonymous = comment.find(\"input[name='anonymous']\").prop(\"checked\") ? \"1\" : \"0\";\n    var name = comment.find(\"input[name='name']\").val();\n    var existName = comment.find(\"input[name='name']\").length ? true : false;\n    if (!content || existName && !name) {\n        if (!content) comment.find(\"textarea\").focus();\n        if (!name) comment.find(\"input[name='name']\").focus();\n        return false;\n    } else {\n        if (objId != undefined) {\n            if (elem.attr(\"data-captcha\") == undefined) {\n                elem.removeAttr(\"data-send\");\n                comment.find(\"img.preloader\").removeClass(\"hide\");\n                $.ajax({\n                    url: \"/udata/content/sendComment/?transform=modules/comments/comments.xsl\",\n                    type: \"POST\",\n                    dataType: 'html',\n                    data: { objId: objId, parent_id: parentId != undefined ? parentId : \"\", name: name, content: content, per_page: per_page, anonymous: anonymous },\n                    success: function success(data) {\n                        comment.find(\"img.preloader\").addClass(\"hide\");\n                        comment.find(\"input[name='name'], textarea\").val('');\n                        comment.find(\"input[name='anonymous']\").prop('checked', false);\n                        var comments = comment.closest(\".comments\");\n                        comments.append($(\".comment.float\"));\n                        $(\".comment.float\").slideUp(function () {\n                            comments.find(\".comments_list\").html(data);\n                            var comments_amount = comments.find(\".comments_amount\").html();\n                            comments.find(\".title span\").html(comments_amount);\n                            initMasonry();\n                        });\n                    }\n                });\n            } else {\n                $(\".comment button\").removeAttr(\"data-send\");\n                elem.attr(\"data-send\", \"1\");\n            }\n        }\n    }\n}\n\n//Подгрузка комментариев ajax\nfunction getListComments(elem, objId, per_page) {\n    elem.find(\"span\").addClass(\"hide\");\n    elem.find(\"img\").removeClass(\"hide\");\n    var per_page = parseInt(per_page) + 20;\n    var comments_list = elem.closest(\".comments_list\");\n    $.ajax({\n        url: \"/udata/content/getListComments/\" + objId + \"/\" + per_page + \"?transform=modules/comments/comments.xsl\",\n        type: \"POST\",\n        dataType: 'html',\n        success: function success(data) {\n            comments_list.html(data);\n            initCutContent();\n            initMasonry();\n        }\n    });\n    return false;\n}\n\n//Обратная связь\nfunction feedback(elem) {\n    if (elem.attr(\"data-captcha\") == undefined) {\n        $(\"#feedback\").modal();\n    } else {\n        elem.attr(\"data-send\", \"1\");\n    }\n}\n\nfunction refreshNewPoll(change, reload_form) {\n    var modify = change ? \"1\" : \"0\";\n    if (reload_form) $(\"#disabled_screen\").removeClass(\"hide\");\n    if (newPoll_refreshNewPollTime) clearTimeout(newPoll_refreshNewPollTime);\n    newPoll_refreshNewPollTime = setTimeout(function () {\n        $(\"#disabled_screen\").addClass(\"hide\");\n        location.reload();\n    }, 10000);\n\n    var data_type = $(\".new_poll_block\").attr(\"data-type\");\n    var data_for = $(\".new_poll_block\").attr(\"data-for\");\n    data_for = data_for != undefined ? data_for : \"\";\n    var data_id = $(\".new_poll_block\").attr(\"data-id\");\n    data_id = data_id != undefined ? data_id : \"\";\n\n    var fast = data_type == \"fast\" ? \"1/\" : \"\";\n\n    var scrollTextarea = $(\".new_poll_block .chanels\").scrollTop();\n\n    $.ajax({\n        url: \"/udata/vote/getNewPollForm/\" + modify + \"/\" + fast + \"?transform=/modules/vote/new_poll_ajax.xsl\",\n        type: \"POST\",\n        dataType: 'html',\n        data: $(\".new_poll_block #new_poll_form\").serialize() + \"&data_for=\" + data_for + \"&data_id=\" + data_id + \"&url=\" + encodeURIComponent(location.href),\n        success: function success(data) {\n            if (reload_form) {\n                var heightImages = $(\".new_poll_block .images\").outerHeight();\n                $(\".new_poll_block\").html(data);\n                $(\".new_poll_block .images\").css(\"height\", heightImages + \"px\");\n\n                $(\".new_poll_block .chanels\").scrollTop(scrollTextarea);\n\n                if (upload_image_currXhr != undefined) upload_image_currXhr.abort();\n                refreshGridster();\n                initCutContent();\n                setTimeout(function () {\n                    initMasonry();\n\n                    if ($(\".new_poll_block\").attr(\"data-tooltips-id\") != '' && $(\".new_poll_block\").attr(\"data-tooltips-id\") !== undefined) $(\".new_poll_block\").addClass(\"tooltips\");\n\n                    if ($(\".poll.medium[data-type='poll']:first\").find(\".settings_item ul\").attr(\"data-tooltips-id\") != '' && $(\".poll.medium[data-type='poll']:first\").find(\".settings_item ul\").attr(\"data-tooltips-id\") !== undefined) {\n                        $(\".poll.medium[data-type='poll']:first\").find(\".settings_item ul\").addClass(\"tooltips\");\n                        $(\".poll.medium[data-type='poll']:first\").find(\".settings_item\").addClass(\"open_for_tooltip\");\n                    }\n\n                    initIntroJs();\n                }, 500);\n                initColorBox();\n                initSetInfo();\n                initTooltips();\n            }\n            $(\"#disabled_screen\").addClass(\"hide\");\n            clearTimeout(newPoll_refreshNewPollTime);\n            newPoll_refreshNewPollTime = false;\n            if (newPoll_last_click !== false) {\n                $(newPoll_last_click).prop(\"disabled\", false);\n                $(newPoll_last_click).click();\n                newPoll_last_click = false;\n            }\n        }\n    });\n}\n\nfunction refreshNewArticle(change, reload_form) {\n    var modify = change ? \"1\" : \"0\";\n    var textarea_height = [];\n    if (reload_form) {\n        $(\".wysiwyg\").each(function () {\n            var id = $(this).attr(\"id\");\n            var editor = CKEDITOR.instances[id];\n            if (editor) {\n                $(\"input[type='hidden'][data-for='\" + id + \"']\").val(CKEDITOR.instances[id].getData());\n                textarea_height[id] = $(\"#cke_\" + id).height() - 7;\n            }\n        });\n\n        $(\"#disabled_screen\").removeClass(\"hide\");\n    }\n    if (newArticle_refreshNewArticleTime) clearTimeout(newArticle_refreshNewArticleTime);\n    newArticle_refreshNewArticleTime = setTimeout(function () {\n        $(\"#disabled_screen\").addClass(\"hide\");\n        location.reload();\n    }, 10000);\n\n    $.ajax({\n        url: \"/udata/content/getNewArticleForm/\" + modify + \"/\" + \"?transform=/modules/content/new_article_ajax.xsl\",\n        type: \"POST\",\n        dataType: 'html',\n        data: $(\"#new_article #new_article_form\").serialize() + \"&url=\" + location.href,\n        success: function success(data) {\n            if (reload_form) {\n                $(\"#new_article\").html(data);\n                if (upload_image_currXhr != undefined) upload_image_currXhr.abort();\n                initCutContent();\n                initColorBox();\n\n                //Чтобы не было скачков в высоте Wysiwyg при перезагрузке, установливаем высоту, сохраненную в textarea_height\n                for (key in textarea_height) {\n                    $(\"#\" + key).height(textarea_height[key]);\n                }\n\n                initWysiwyg();\n                initSetInfo();\n                initTooltips();\n            }\n            $(\"#disabled_screen\").addClass(\"hide\");\n            clearTimeout(newArticle_refreshNewArticleTime);\n            newArticle_refreshNewArticleTime = false;\n            if (newArticle_last_click !== false) {\n                $(newArticle_last_click).click();\n                newArticle_last_click = false;\n            }\n        }\n    });\n}\n\nfunction UploadImage(do_, elem) {\n    upload_image_crop = false;\n    $(\"#upload_image form input[type='file']\").unbind();\n    $(\"#upload_image .form-group>input[type='text']\").unbind();\n    $(\"#upload_image .apply\").unbind();\n    $(\"#upload_image .close_abort\").unbind();\n    $(\"#upload_image form\").ajaxFormUnbind();\n    $(\"#upload_image .apply\").prop(\"disabled\", true);\n    $(\"#upload_image input\").val(\"\");\n    $(\"#upload_image input[type='text']\").attr(\"old_value\", \"\");\n    $(\"#upload_image .cropper>img\").cropper(\"destroy\");\n    $('#upload_image .cropper').html('');\n\n    fragment = elem.attr(\"data-fragment\");\n    var data_url = elem.attr(\"data-url\");\n    var data_parameters = elem.attr(\"data-parameters\");\n    $(\"#upload_image\").attr(\"data-fragment\", fragment);\n    $(\"#upload_image .cropper\").attr(\"data-fragment\", fragment);\n    $(\"#upload_image form\").attr(\"action\", data_url);\n    $(\"#upload_image input[name='parameters']\").val(data_parameters);\n\n    $(\"#upload_image\").modal();\n\n    $(\"#upload_image form input[type='file']\").unbind();\n    $(\"#upload_image form input[type='file']\").on(\"change\", function () {\n        $(\"#upload_image form\").submit();\n    });\n\n    $(\"#upload_image .form-group>input[type='text']\").unbind();\n    $(\"#upload_image .form-group>input[type='text']\").on(\"keyup\", function () {\n        var stat = false;\n        if ($(this).attr(\"old_value\") != undefined) {\n            if ($(this).attr(\"old_value\") != $(this).val()) stat = true;\n        } else stat = true;\n\n        if (stat) {\n            $(\"#upload_image .preloader\").removeClass(\"hide\");\n            $(this).attr(\"old_value\", $(this).val());\n            $(\"#upload_image .apply\").prop(\"disabled\", true);\n            $.ajax({\n                url: \"/udata/content/checkImageUrl/.json\",\n                type: \"POST\",\n                dataType: 'json',\n                data: { url: $(this).val() },\n                success: function success(data) {\n                    if (data.result != \"0\") $(\"#upload_image .apply\").prop(\"disabled\", false);else $(\"#upload_image .apply\").prop(\"disabled\", true);\n                    $(\"#upload_image .preloader\").addClass(\"hide\");\n                }\n            });\n        }\n    });\n\n    $(\"#upload_image .apply\").unbind();\n    $(\"#upload_image .apply\").click(function () {\n        var crop = \"\";\n        if (upload_image_crop != false) {\n            var cropX = upload_image_crop.x;\n            var cropY = upload_image_crop.y;\n            var cropWidth = upload_image_crop.width;\n            var cropHeight = upload_image_crop.height;\n            crop = cropX + \"_\" + cropY + \"_\" + cropWidth + \"_\" + cropHeight;\n            $(\"#upload_image input[name='crop']\").val(crop);\n        }\n        var parameters = $(\"#upload_image input[name='parameters']\").val();\n\n        $(\"#upload_image .preloader\").removeClass(\"hide\");\n        $(\"#upload_image input[type='text'],#upload_image button.apply\").prop(\"disabled\", true);\n        $.ajax({\n            url: $(\"#upload_image form\").attr(\"action\") + \"1\",\n            type: \"POST\",\n            dataType: 'html',\n            data: { url: $(\"#upload_image .form-group>input[type='text']\").val(), crop: crop, parameters: parameters },\n            success: function success(data) {\n                if (fragment != '' && upload_image_crop === false) uploadImageFragment(do_);else uploadImageComplete(do_);\n            }\n        });\n    });\n    $(\"#upload_image .close_abort\").unbind();\n    $(\"#upload_image .close_abort\").on(\"click\", function () {\n        if (upload_image_currXhr) upload_image_currXhr.abort();\n    });\n\n    $(\"#upload_image form\").ajaxForm({\n        beforeSend: function beforeSend(xhr) {\n            upload_image_currXhr = xhr;\n            $(\"#upload_image .preloader\").removeClass(\"hide\");\n            $(\"#upload_image input[type='text'],#upload_image button.apply\").prop(\"disabled\", true);\n        },\n        uploadProgress: function uploadProgress(event, position, total, percentComplete) {\n            $(\"#upload_image .progress_bar\").removeClass(\"hide\");\n            $(\"#upload_image .progress_bar\").html(percentComplete + \"%\");\n        },\n        success: function success() {\n            $(\"#upload_image .progress_bar\").addClass(\"hide\");\n        },\n        complete: function complete(response) {\n            if (fragment != '') uploadImageFragment(do_);else uploadImageComplete(do_);\n        },\n        error: function error() {}\n    });\n}\n\n//Закрытие окна загрузки изображения и обновление страницы\nfunction uploadImageComplete(do_) {\n    $(\"#upload_image .cropper>img\").cropper(\"destroy\");\n\n    $(\"#upload_image button.apply\").prop(\"disabled\", true);\n    $(\"#upload_image .preloader\").addClass(\"hide\");\n    $(\"#upload_image input[type='text'],#upload_image button.apply\").prop(\"disabled\", false);\n    $(\"#upload_image\").modal('hide');\n    $(\"body\").removeClass(\"modal-open\");\n    switch (do_) {\n        case \"poll_new_image\":\n            refreshNewPoll(true, true);\n            break;\n        case \"upload_image_article\":\n            refreshNewArticle(true, true);\n            break;\n        case \"upload_image_profile\":\n            cabinet_profile();\n            break;\n        case \"upload_image_feed\":\n            location.reload();\n            break;\n    }\n}\n\n//Выбор фрагмента изображения после загрузки\nfunction uploadImageFragment(do_) {\n    $(\"#upload_image .preloader\").addClass(\"hide\");\n    $(\"#upload_image input[type='text'],#upload_image button.apply\").prop(\"disabled\", false);\n    $.ajax({\n        url: \"/udata/content/getImageName/.json\",\n        type: \"POST\",\n        dataType: 'json',\n        data: { session_name: do_ },\n        success: function success(data) {\n            $('#upload_image .cropper img').remove();\n            $('#upload_image .cropper').unbind();\n            $('#upload_image .cropper').html('<label>Выберите фрагмент изображения</label><img class=\"hide\" src=\"' + data.image + \".jpg\" + '\" />');\n            initCropper();\n        }\n    });\n}\n\nfunction refreshGridster() {\n    newPoll_gridsterTimer = false;\n    var gridster_margins = [1, 1];\n    var max_size_item = [6, 6];\n\n    newPoll_gridster = $(\".new_poll_block .gridster ul\").gridster({\n        widget_margins: gridster_margins,\n        widget_base_dimensions: [145, 100],\n        resize: {\n            enabled: true,\n            max_size: max_size_item,\n            resize: function resize(e, ui, $widget) {\n                viewImage();\n                updatePoolForGridster();\n            }\n        },\n        draggable: {\n            stop: function stop(event, ui) {\n                viewImage();\n                updatePoolForGridster();\n            }\n        },\n        max_size_x: max_size_item[0],\n        max_size_y: max_size_item[0],\n        max_cols: max_size_item[0]\n    }).data('gridster');\n\n    viewImage();\n\n    //Отключение контекстного меню\n    $(\".new_poll_block .gridster\").closest(\"#new_poll_form\").on(\"contextmenu\", false);\n\n    $(\".new_poll_block .gridster ul li\").mousedown(function (event) {\n        if (event.preventDefault) event.preventDefault();else event.returnValue = false;\n\n        if (event.button == 2) {\n            var top = parseInt($(this).attr(\"data-top\") != undefined ? $(this).attr('data-top') : 0);\n            var left = parseInt($(this).attr(\"data-left\") != undefined ? $(this).attr('data-left') : 0);\n            newPoll_gridster_li_move = [$(this), event.pageX, event.pageY, left, top];\n        }\n    });\n\n    $(\".new_poll_block .gridster ul li\").hover(function () {\n        $(this).find(\".remove\").fadeIn();\n        $(this).find(\".move\").fadeIn();\n    }, function () {\n        $(this).find(\".remove\").fadeOut();\n        $(this).find(\".move\").fadeOut();\n    });\n\n    $(\"body\").mouseup(function (event) {\n        if (event.preventDefault) event.preventDefault();else event.returnValue = false;\n\n        if (event.button == 0) {\n            if (newPoll_gridster_move_time !== false) {\n                clearInterval(newPoll_gridster_move_time);\n                newPoll_gridster_move_time = false;\n            }\n            if (newPoll_gridster_move_time_start !== false) {\n                clearInterval(newPoll_gridster_move_time_start);\n                newPoll_gridster_move_time_start = false;\n            }\n        }\n\n        if (event.button == 2) {\n            if (newPoll_gridster_li_move !== false) {\n                newPoll_gridster_li_move = false;\n                //......\n                //......\n            }\n        }\n    });\n\n    //Передвижение изображений\n    $(\"#new_poll_form\").on(\"mousemove\", function (event) {\n        if (newPoll_gridster_li_move !== false) {\n            var li = newPoll_gridster_li_move[0];\n            var mT = event.pageY - newPoll_gridster_li_move[2] + newPoll_gridster_li_move[4];\n            var mL = event.pageX - newPoll_gridster_li_move[1] + newPoll_gridster_li_move[3];\n            li.attr(\"data-top\", Math.round(mT));\n            li.attr(\"data-left\", Math.round(mL));\n            viewImage();\n            updatePoolForGridster();\n        }\n    });\n\n    $(\".new_poll_block .gridster ul li .move\").mousedown(function (event) {\n        if (event.preventDefault) event.preventDefault();else event.returnValue = false;\n\n        if (event.button == 0) {\n            this_ = $(this);\n            gridster_move(this_);\n            newPoll_gridster_move_time_start = setTimeout(function () {\n                newPoll_gridster_move_time = setInterval(function () {\n                    gridster_move(this_);\n                }, 50);\n            }, 500);\n        }\n    });\n\n    //Изменение масштаба изображений\n    $(\".new_poll_block .gridster ul li\").unbind('mousewheel DOMMouseScroll').on('mousewheel DOMMouseScroll', function (e) {\n        if ($(this).attr(\"data-width\") == undefined) $(this).attr(\"data-width\", \"100\");\n        var width = parseInt($(this).attr(\"data-width\"));\n        var delta = Math.floor(2 * (width / 100));\n\n        if (e.deltaY < 0) var new_width = width - delta;else var new_width = width + delta;\n\n        $(this).attr(\"data-width\", Math.round(new_width));\n        viewImage();\n        e.preventDefault();\n        e.stopPropagation();\n\n        updatePoolForGridster();\n    });\n}\nfunction viewImage() {\n    var stat = true;\n    if (viewImageTimer) clearInterval(viewImageTimer);\n    $(\".new_poll_block .gridster ul li img\").each(function () {\n        if (!$(this).height()) stat = false;\n    });\n    if (!stat) {\n        viewImageTimer = setTimeout(function () {\n            viewImage();\n        }, 300);\n        return;\n    }\n    clearInterval(viewImageTimer);\n    $(\".new_poll_block .images\").css(\"height\", \"auto\"); //При перезагрузке страницы refreshNewPoll, устанавливается высота, чтобы не было скачков. Здесь сбрасывается.\n    $(\".new_poll_block .gridster ul li\").each(function () {\n        reViewImage($(this));\n    });\n}\n\nfunction reViewImage(elem) {\n    var id = elem.attr(\"data-id\");\n    var left = parseInt(elem.attr(\"data-left\"));\n    var top = parseInt(elem.attr(\"data-top\"));\n    var width = parseInt(elem.attr(\"data-width\"));\n    var row = parseInt(elem.attr(\"data-row\"));\n    var col = parseInt(elem.attr(\"data-col\"));\n    var sizex = parseInt(elem.attr(\"data-sizex\"));\n    var sizey = parseInt(elem.attr(\"data-sizey\"));\n\n    //Подбор масштаба\n    var img_width = elem.find(\"img\").width();\n    var img_height = elem.find(\"img\").height();\n    var li_width = elem.width();\n    var li_height = elem.height();\n\n    if (img_width && img_height && li_width && li_height) {\n        var img_koef = img_width / img_height;\n        var li_koef = li_width / li_height;\n        if (img_koef > li_koef) {\n            var s_width = 100 * img_koef / li_koef;\n            if (width < s_width) {\n                elem.attr(\"data-top\", \"0\");\n                elem.attr(\"data-left\", \"0\");\n                elem.attr(\"data-width\", Math.round(s_width));\n            }\n        } else {\n            if (width < 100) {\n                elem.attr(\"data-top\", \"0\");\n                elem.attr(\"data-left\", \"0\");\n                elem.attr(\"data-width\", \"100\");\n            }\n        }\n    }\n\n    var width_img = elem.find(\"img\").width();\n    var height_img = elem.find(\"img\").height();\n    height_img = !height_img ? 1 : height_img;\n    var koef_img = width_img / height_img;\n    var width_li = elem.width();\n    var height_li = elem.height();\n    height_li = !height_li ? 1 : height_li;\n    var koef_li = width_li / height_li;\n    min_width = koef_img <= koef_li ? 100 : 100 * koef_img / koef_li;\n    width = Math.round(width < min_width ? min_width : width);\n    width = koef_img <= koef_li ? width > 250 ? 250 : width : width / (koef_img / koef_li) > 250 ? 250 * koef_img / koef_li : width;\n    top = top > 0 ? 0 : top;\n    left = left > 0 ? 0 : left;\n    var maxDeltaT = width / 100 * width_li / koef_img - height_li;\n    top = top < -maxDeltaT ? -maxDeltaT : top;\n    var maxDeltaL = width / 100 * width_li - width_li;\n    left = left < -maxDeltaL ? -maxDeltaL : left;\n\n    elem.find(\"img\").css(\"margin-top\", Math.round(top) + \"px\");\n    elem.attr(\"data-top\", Math.round(top));\n    elem.find(\"img\").css(\"margin-left\", Math.round(left) + \"px\");\n    elem.attr(\"data-left\", Math.round(left));\n    elem.find(\"img\").css(\"width\", Math.round(width) + \"%\");\n    elem.attr(\"data-width\", Math.round(width));\n    elem.find(\"input[data-name='top']\").val(Math.round(top));\n    elem.find(\"input[data-name='left']\").val(Math.round(left));\n    elem.find(\"input[data-name='width']\").val(Math.round(width));\n    elem.find(\"input[data-name='row']\").val(row);\n    elem.find(\"input[data-name='col']\").val(col);\n    elem.find(\"input[data-name='sizex']\").val(sizex);\n    elem.find(\"input[data-name='sizey']\").val(sizey);\n}\n\nfunction updatePoolForGridster() {\n    if (newPoll_gridsterTimer !== false) {\n        clearTimeout(newPoll_gridsterTimer);\n        newPoll_gridsterTimer = false;\n    }\n    newPoll_gridsterTimer = setTimeout(function () {\n        var total_height = 0;\n        $(\".new_poll_block .gridster ul li\").each(function () {\n            var li = $(this);\n            var getSizeY = parseInt(li.attr('data-row')) + parseInt(li.attr('data-sizey')) - 1;\n            if (getSizeY > total_height) total_height = getSizeY;\n        });\n        if (total_height > 6) $(\".new_poll_block .images\").addClass(\"error\");else $(\".new_poll_block .images\").removeClass(\"error\");\n\n        refreshNewPoll(true, false);\n    }, 1000);\n}\n\nfunction gridster_move(elem) {\n    var li = elem.closest(\"li\");\n    var top = parseInt(li.attr(\"data-top\") != undefined ? li.attr(\"data-top\") : 0);\n    var left = parseInt(li.attr(\"data-left\") != undefined ? li.attr(\"data-left\") : 0);\n    if (elem.hasClass(\"to_left\")) left -= 10;\n    if (elem.hasClass(\"to_top\")) top -= 10;\n    if (elem.hasClass(\"to_right\")) left += 10;\n    if (elem.hasClass(\"to_down\")) top += 10;\n    li.attr(\"data-top\", top);\n    li.attr(\"data-left\", left);\n    viewImage();\n    updatePoolForGridster();\n}\n\nfunction getInterestsList() {\n    $(\"#cabinet .interests .preloader\").removeClass(\"hide\");\n    $.ajax({\n        url: \"/udata/users/getInterestsOfUser/?transform=modules/users/get_profile_ajax.xsl\",\n        type: \"POST\",\n        dataType: 'html',\n        success: function success(data) {\n            $(\".interests ul.list\").html(data);\n            $(\".interests .preloader\").addClass(\"hide\");\n\n            $(\"#cabinet .interests .remove\").unbind();\n            $(\"#cabinet .interests .remove\").click(function () {\n                $(\"#cabinet .interests .preloader\").removeClass(\"hide\");\n                var id = $(this).data('id');\n                $.ajax({\n                    url: \"/udata/users/removeInterestsOfUser/\",\n                    type: \"POST\",\n                    dataType: 'html',\n                    data: { id: id },\n                    success: function success(data) {\n                        getInterestsList();\n                    }\n                });\n            });\n\n            $(\"#cabinet .interests .add\").unbind();\n            $(\"#cabinet .interests .add\").click(function () {\n                var id = false;\n                if ($(\"#cabinet .interests select[data-cat='3']\").val()) id = $(\"#cabinet .interests select[data-cat='3']\").val();else if ($(\"#cabinet .interests select[data-cat='2']\").val()) id = $(\"#cabinet .interests select[data-cat='2']\").val();else if ($(\"#cabinet .interests select[data-cat='1']\").val()) id = $(\"#cabinet .interests select[data-cat='1']\").val();\n\n                if (id !== false) {\n                    $(\"#cabinet .interests .preloader\").removeClass(\"hide\");\n                    $.ajax({\n                        url: \"/udata/users/addInterestsOfUser/\",\n                        type: \"POST\",\n                        dataType: 'html',\n                        data: { id: id },\n                        success: function success(data) {\n                            getInterestsList();\n                        }\n                    });\n                }\n                return false;\n            });\n\n            $(\"#cabinet .interests .categories>li\").each(function () {\n                var id = $(this).data(\"id\");\n                var name = $(this).data(\"name\");\n                $(\"#cabinet .interests select[data-cat='1']\").append(\"<option value='\" + id + \"'>\" + name + \"</option>\");\n            });\n\n            $(\"#cabinet .interests select\").unbind();\n            $(\"#cabinet .interests select\").change(function () {\n                var cat = $(this).val();\n                var level = parseInt($(this).data(\"cat\"));\n                var id = $(this).val();\n                $(\"#cabinet .interests select[data-cat='\" + (level + 1) + \"']\").text('');\n                if ($(\"#cabinet .interests .categories li[data-id='\" + id + \"']>ul>li\").length) {\n                    $(\"#cabinet .interests select[data-cat='\" + (level + 1) + \"']\").append(\"<option value=''>...</option>\");\n                    $(\"#cabinet .interests span[data-cat='\" + (level + 1) + \"']\").removeClass(\"hide\");\n                    $(\"#cabinet .interests select[data-cat='\" + (level + 1) + \"']\").removeClass(\"hide\");\n                    $(\"#cabinet .interests\").attr(\"data-level\", level + 1);\n                    $(\"#cabinet .interests .categories li[data-id='\" + id + \"']>ul>li\").each(function () {\n                        var id = $(this).data(\"id\");\n                        var name = $(this).data(\"name\");\n                        $(\"#cabinet .interests select[data-cat='\" + (level + 1) + \"']\").append(\"<option value='\" + id + \"'>\" + name + \"</option>\");\n                    });\n                } else {\n                    $(\"#cabinet .interests\").attr(\"data-level\", level);\n                    $(\"#cabinet .interests span[data-cat='\" + (level + 1) + \"']\").addClass(\"hide\");\n                    $(\"#cabinet .interests select[data-cat='\" + (level + 1) + \"']\").addClass(\"hide\");\n                    $(\"#cabinet .interests span[data-cat='\" + (level + 2) + \"']\").addClass(\"hide\");\n                    $(\"#cabinet .interests select[data-cat='\" + (level + 2) + \"']\").addClass(\"hide\");\n                }\n                return false;\n            });\n            $(\"#cabinet .interests select:first\").change();\n            init_counter();\n        }\n    });\n}\n\nfunction initMasonry() {\n    if (initMasonryInstance) $(\".masonry\").masonry('destroy');\n\n    var scrollTop = $(\"body\").scrollTop();\n\n    $(\".masonry\").each(function () {\n        var getClass = $(this).attr(\"data-class-masonry\");\n        var getGutter = parseInt($(this).attr(\"data-masonry-gutter\"));\n        $(this).masonry({\n            itemSelector: '.' + getClass,\n            gutter: getGutter\n        });\n    });\n    initMasonryInstance = true;\n    $(\"body\").scrollTop(scrollTop);\n}\n\nfunction initGoogleMap() {\n    googleMapEnabled = true;\n}\n\nfunction drawGoogleMaps() {\n    if (googleMapEnabled) {\n        $(\".googleMap\").each(function () {\n            drawGoogleMap($(this), '');\n        });\n    }\n}\n\nfunction drawGoogleMap(elemGM, param0, param1) {\n    var elem = elemGM.children(\"div\");\n    var idMap = elem.attr(\"id\");\n    var mapType = elem.attr(\"data-mapType\");\n    var pollId = elem.attr(\"data-pollId\") != undefined ? elem.attr(\"data-pollId\") : false;\n    //var width = parseInt(elem.attr(\"data-width\"));\n    //var height= parseInt(elem.attr(\"data-height\"));\n    var param0 = param0 ? param0 : '';\n    var param1 = param1 ? param1 : \"\";\n\n    switch (mapType) {\n        case \"poll\":\n            if (pollId) {\n                elemGM.removeClass(\"hidePreloader\");\n                $.ajax({\n                    url: \"/udata/vote/getPollMap/\" + pollId + \"/\" + param1 + \"/.json\",\n                    type: \"POST\",\n                    data: param0,\n                    dataType: 'json',\n                    success: function success(getData) {\n                        if (getData.regions != undefined && getData.region != undefined) {\n                            var rowsTable = [];\n                            votes = getData.votes.item != undefined ? getData.votes.item : [];\n                            for (var vote in votes) {\n                                if (votes[vote].region != undefined && votes[vote].votes != undefined && votes[vote].name != undefined) rowsTable.push([votes[vote].region, votes[vote].votes, votes[vote].name]);\n                            }var data = new google.visualization.DataTable();\n                            data.addColumn('string', 'region');\n                            data.addColumn('number', 'Голосов');\n                            data.addColumn('string', 'Display');\n                            data.addRows(rowsTable);\n                            var geochart = new google.visualization.GeoChart(document.getElementById(idMap));\n                            var formatter = new google.visualization.PatternFormat('{1}');\n                            formatter.format(data, [0, 2]);\n                            var view = new google.visualization.DataView(data);\n                            view.setColumns([0, 1]);\n\n                            geochart.draw(view, {\n                                //width: width,\n                                //height: height,\n                                region: getData.region,\n                                resolution: getData.regions,\n                                colorAxis: { colors: ['#B9D3EE', '#104E8B'] }\n                            });\n\n                            elemGM.addClass(\"hidePreloader\");\n\n                            if (rowsTable.length && getData.regions != 'provinces') {\n                                google.visualization.events.addListener(geochart, 'regionClick', function (e) {\n                                    drawGoogleMap(elemGM, param0, e.region);\n                                });\n                            }\n                            if (param1) $(\".googleMapZoomOut[data-for_map='\" + idMap + \"']\").removeClass(\"hide\");else $(\".googleMapZoomOut[data-for_map='\" + idMap + \"']\").addClass(\"hide\");\n                            $(\".googleMapZoomOut[data-for_map='\" + idMap + \"']\").unbind();\n                            $(\".googleMapZoomOut[data-for_map='\" + idMap + \"']\").on(\"click\", function () {\n                                drawGoogleMap(elemGM, param0);\n                            });\n                            $(\".googleMapSelect\").unbind();\n                            $(\".googleMapSelect\").on(\"click\", function () {\n                                elemGM.removeClass(\"hidePreloader\");\n                                var active = $(this).hasClass(\"active\") ? false : true;\n                                if (active) {\n                                    $(this).addClass(\"active\");\n                                    $(this).find(\"input[type='hidden']\").prop(\"disabled\", false);\n                                } else {\n                                    $(this).removeClass(\"active\");\n                                    $(this).find(\"input[type='hidden']\").prop(\"disabled\", true);\n                                }\n\n                                var for_map = $(this).attr(\"data-for_map\");\n                                var serFM = '';\n                                /*if (!$(\".googleMapSelect[data-for_map='\"+for_map+\"'].active\").length)\r\n                                 $(\".googleMapSelect[data-for_map='\"+for_map+\"']\").addClass(\"active\");*/\n                                serFM = $(this).closest(\"form\").serialize() + \"&custom=1\";\n                                /*$(\".googleMapSelect[data-for_map='\"+for_map+\"'].active\").each(function(){\r\n                                 var variantId = $(this).attr(\"data-variant_id\");\r\n                                 serFM += variantId+\",\";\r\n                                 });*/\n                                if (googleMapSelectTimer !== false) clearTimeout(googleMapSelectTimer);\n                                googleMapSelectTimer = setTimeout(function () {\n                                    drawGoogleMap($(\"#\" + for_map).closest(\".googleMap\"), serFM);\n                                }, 2000);\n                            });\n                        } else {\n                            elemGM.addClass(\"hidePreloader\");\n                        }\n                    }\n                });\n            }\n            break;\n    }\n}\n\n//Ограничение текста по высоте блоков класса content_cut\nfunction initCutContent() {\n    $(\".content_cut\").each(function () {\n        var id = $(this).attr(\"data-cut-id\");\n        var setHeight = $(this).attr(\"data-cut-height\");\n        $(this).css(\"height\", \"auto\");\n        if ($(this).outerHeight() - 50 > setHeight) {\n            $(this).css(\"height\", setHeight + \"px\");\n            $(\"a.open_cut[data-for-cut='\" + id + \"']\").removeClass(\"hide\");\n        }\n    });\n    $(\".open_cut\").click(function () {\n        var id = $(this).attr(\"data-for-cut\");\n        var block = $(this).parent().find(\".content_cut[data-cut-id='\" + id + \"']\");\n        block.css(\"height\", \"auto\");\n        block.removeClass('content_cut');\n        $(this).remove();\n        setTimeout(function () {\n            initMasonry();\n        }, 500);\n        return false;\n    });\n}\n\nfunction initWysiwyg() {\n    $(\".wysiwyg\").each(function () {\n        var id = $(this).attr(\"id\");\n        var editor = CKEDITOR.instances[id];\n        if (editor) editor.destroy(true);\n        CKEDITOR.replace(id, {\n            toolbarGroups: [{ name: 'document', groups: ['mode', 'document'] }, // Displays document group with its two subgroups.\n            { name: 'clipboard', groups: ['clipboard', 'undo'] }, // Group's name will be used to create voice label.\n            { name: 'basicstyles', groups: ['basicstyles', 'cleanup'] }],\n            toolbar: [{ name: 'document', items: ['Source'] }, // Defines toolbar group with name (used to create voice label) and items in 3 subgroups.\n            ['Cut', 'Copy', 'Paste', 'PasteText', 'PasteFromWord', '-', 'Undo', 'Redo'], // Defines toolbar group without name.\n            { name: 'basicstyles', items: ['Bold', 'Italic'] }]\n        });\n    });\n    /*if ($(\"#feed_description\").length){\r\n     var editor = CKEDITOR.instances['feed_description'];\r\n     if (editor) editor.destroy(true);\r\n     CKEDITOR.replace('feed_description',{\r\n     toolbarGroups: [\r\n     { name: 'basicstyles', groups: [ 'basicstyles', 'cleanup' ] }\r\n     ],\r\n     toolbar: [\r\n     { name: 'basicstyles', items: [ 'Bold', 'Italic' ] }\r\n     ]\r\n     });\r\n     }*/\n}\n\n//Вывод в панель информации содержимого блоков .set_info\nfunction initSetInfo() {\n    $(\"#panel_info .content\").html(\"\");\n    $(\".set_info.clone\").remove();\n    if ($(\".set_info\").length) {\n        $(\".shell\").addClass(\"ib\");\n        $(\".set_info\").each(function () {\n            $(this).clone().removeClass(\"hide\").addClass(\"clone\").appendTo(\"#panel_info .content\");\n        });\n        initWysiwyg();\n    } else {\n        $(\".shell\").removeClass(\"ib\");\n    };\n    openAlerts();\n}\n\n//Показать/изменить данные пользователя в кабинете\nfunction cabinet_profile() {\n    $.ajax({\n        url: \"/udata/users/getProfile/?transform=modules/users/get_profile_ajax.xsl\",\n        type: \"POST\",\n        dataType: 'html',\n        success: function success(data) {\n            $(\"#cabinet_profile\").html(data);\n\n            getInterestsList();\n            initColorBox();\n\n            $(\"#profile\").cc_validate({\n                settings: { required_class: 'required', error_class: 'error' },\n                rules: [{ element: \"input[name='email']\", rule: 'check', url: '/users/checkEmail/1/', need: 'false' }, { element: \"input[name='password_confirm']\", rule: 'compare', compare: \"input[name='password']\" }, { element: \"input[name='password']\", rule: 'min_length_null', min_length: 6 }, { element: \"input[name='old_password']\", rule: 'check', url: '/users/checkPassword/', need: 'true' }],\n                warning: function warning(elem, rule, result) {\n                    elem.closest(\".form-group\").find(\".label-warning-\" + rule).removeClass(\"hide\");\n                    var err = elem.attr(\"data-error\");\n                    elem.closest(\".form-group\").find(\".label\").removeClass(\"hide\" + err);\n                },\n                hide_warning: function hide_warning(elem, rule, result) {\n                    elem.closest(\".form-group\").find(\".label-warning-\" + rule).addClass(\"hide\");\n                    var err = elem.attr(\"data-error\");\n                    elem.closest(\".form-group\").find(\".label\").addClass(\"hide\" + err);\n                },\n                success: function success(form) {\n                    form.submit();\n                }\n            });\n\n            $(\"#cabinet .profile .avatar span.remove\").click(function () {\n                $(\"#cabinet .profile .saving\").removeClass(\"hide\");\n                $.ajax({\n                    url: \"/udata/users/removePhoto/\",\n                    type: \"POST\",\n                    dataType: 'html',\n                    success: function success(data) {\n                        setTimeout(function () {\n                            $(\"#cabinet .profile .saving\").addClass(\"hide\");\n                            cabinet_profile();\n                        }, 1000);\n                    }\n                });\n            });\n        }\n    });\n}\n\nfunction initCropper() {\n    $('.cropper').each(function () {\n        var fragment = parseFloat($(this).attr(\"data-fragment\"));\n        fragment = fragment == 0 ? NaN : fragment;\n\n        var findImg = $(this).find('img');\n\n        if (findImg.length) {\n            var image = new Image();\n            image.src = findImg.attr(\"src\");\n            var widthImage;\n            image.onload = function () {\n                widthImage = this.width;\n            };\n\n            findImg.cropper({\n                aspectRatio: fragment,\n                movable: false,\n                zoomable: false,\n                rotatable: false,\n                responsive: false,\n                scalable: false,\n                autoCropArea: 0.8,\n                /*minContainerWidth: 300,*/\n                minContainerHeight: 300,\n                minCropBoxWidth: 50,\n                minCropBoxHeight: 50,\n                crop: function crop(e) {\n                    upload_image_crop = e;\n\n                    if (isNaN(fragment)) {\n                        var aspect = e.width / e.height;\n                        var widthWindow = $(\".cropper-canvas\").width();\n\n                        if (aspect < 0.967) {\n                            $(this).cropper('setCropBoxData', { width: e.width * widthWindow / widthImage + 1 });\n                        }\n                        if (aspect > 2.9) {\n                            $(this).cropper('setCropBoxData', { width: e.width * widthWindow / widthImage - 1 });\n                        }\n                    }\n                }\n            });\n        }\n    });\n}\n\n//Подписаться/отписаться на ленту\nfunction feedSubscribe(elem) {\n    var parent = elem.parent();\n    elem.html(\"<img src='/templates/iview/images/preloader.gif' />\");\n    $.ajax({\n        url: \"/udata/vote/subscribe/\" + elem.attr(\"data-feed-id\") + \"/?transform=modules/feeds/feeds.xsl\",\n        type: \"POST\",\n        dataType: 'html',\n        success: function success(data) {\n            parent.html(data);\n            parent.find(\"button:not(.disabled)\").on(\"click\", function () {\n                if (!$(this).hasClass(\"no-auth\")) {\n                    feedSubscribe($(this));\n                }\n            });\n        }\n    });\n}\n\n//Если есть get параметр goto, переходит на позицию элемента с указанным идентификатором\nfunction goto() {\n    var goto = $(\"#service-information\").attr(\"data-goto\");\n    if (goto) if ($(\".poll.\" + goto).length) {\n        var destination = $(\".poll.\" + goto).offset().top;\n        destination -= 50;\n        if (destination > 0) $('html,body').animate({ scrollTop: destination }, 600);\n    }\n    return false;\n}\n\n//Автоматическое открытие alert'ов которые прописаны в cookies\nfunction openAlerts() {\n    $(\"#panel_info .alert .slidedown_title[data-for-content]\").each(function () {\n        var id = $(this).attr(\"data-for-content\");\n        if ($.cookie('alert_slidedown_' + id) === null) $(this).click();\n    });\n}\n\n//Показ адаптивных изображений\nfunction adaptiveImage() {\n    $(\".adaptive_image\").each(function () {\n        var width = $(this).width();\n        var data_width = parseInt($(this).attr('data-width'));\n        if (data_width > width - 300 && data_width < width + 300) {\n            $(this).attr(\"src\", $(this).attr(\"data-src\"));\n            $(this).removeClass('adaptive_image');\n            $(this).removeAttr('data-src');\n            $(this).removeAttr('data-width');\n        } else $(this).remove();\n    });\n}\n\nfunction init_dot() {\n    $(\".dot\").dotdotdot();\n}\n\n//Иконка воспроизведения видео (центрирование)\nfunction initPlayVideoIcon() {\n    $(\".poll .play_ico\").each(function () {\n        var P = $(this).closest(\"td\");\n        var hP = P.height();\n        var wP = P.width();\n        var hB = $(this).height();\n        var wB = $(this).width();\n        $(this).css(\"top\", hP / 2 - hB / 2 + 'px');\n        $(this).css(\"left\", wP / 2 - wB / 2 + 'px');\n        $(this).removeClass('hide');\n    });\n}\n\n//Удаление комментариев\nfunction comment_remove(id) {\n    $.ajax({\n        url: '/udata/content/comment_remove/' + id,\n        type: 'POST',\n        dataType: 'html',\n        success: function success(data) {\n            location.reload();\n        }\n    });\n}\n\n//Создание опроса по шаблону\nfunction poll_create_from_template(id) {\n    $.ajax({\n        url: '/vote/editPoll/' + id + '/0/1/',\n        type: 'POST',\n        dataType: 'html',\n        success: function success(data) {\n            refreshNewPoll(false, true);\n            var destination = $(\".new_poll_block\").offset().top;\n            destination -= 50;\n            if (destination > 0) $('html,body').animate({ scrollTop: destination }, 600);\n        }\n    });\n}\n\n//Пошаговые подсказки\nfunction initIntroJs() {\n    var steps = [];\n    var ids = '';\n    $(\".tooltips\").each(function () {\n        steps.push({ element: \"[data-tooltips-id='\" + $(this).attr(\"data-tooltips-id\") + \"']\", intro: $(this).attr(\"data-tooltips-content\"), position: $(this).attr(\"data-tooltips-pos\") });\n        ids += $(this).attr(\"data-tooltips-id\") + \",\";\n    });\n\n    if (steps.length) {\n        var introguide = introJs();\n        introguide.setOptions({\n            steps: steps,\n            showStepNumbers: false,\n            exitOnEsc: true,\n            nextLabel: \"След.\",\n            prevLabel: \"Пред.\",\n            skipLabel: \"Пропустить\",\n            doneLabel: \"OK\",\n            // showButtons: false,\n            showBullets: false,\n            scrollToElement: true\n        });\n        introguide.start();\n\n        introguide.onexit(function () {\n            initIntroJsComplete(ids);\n        });\n        introguide.oncomplete(function () {\n            initIntroJsComplete(ids);\n        });\n    }\n}\nfunction initIntroJsComplete(ids) {\n    $.ajax({\n        url: \"/udata/content/tooltips/\",\n        type: \"POST\",\n        data: { ids: ids },\n        dataType: 'html',\n        success: function success(data) {}\n    });\n    $(\".tooltips\").each(function () {\n        $(this).removeClass(\"tooltips\");\n        $(this).removeAttr(\"data-tooltips-id\");\n        $(this).removeAttr(\"data-tooltips-content\");\n        $(this).removeAttr(\"data-tooltips-pos\");\n    });\n    $(\".open_for_tooltip\").removeClass(\"open_for_tooltip\");\n}\n\n//Выбор ответа в опросе\nfunction pollSelectVariant(elem) {\n    var a = elem.find(\"input\");a.attr(\"sel\", \"\");\n    var p = elem.closest(\".poll\");\n    var max = p.attr(\"data-multiple\");\n    if (max == 1) {\n        p.find(\"input[type='checkbox']\").each(function () {\n            var b = $(this);\n            b.prop(\"disabled\", false);\n            b.prop(\"checked\", b.attr(\"sel\") != undefined ? true : false);\n        });\n        a.removeAttr(\"sel\");\n    } else {\n        var s = a.prop(\"checked\");\n        if (!a.prop(\"disabled\")) a.prop(\"checked\", s ? false : true);\n        var m = p.find(\"input[type='checkbox']:checked\").length >= max ? true : false;\n        p.find(\"input[type='checkbox']\").each(function () {\n            var b = $(this);\n            b.prop(\"disabled\", m && !b.prop(\"checked\") ? true : false);\n        });\n    }\n    if (p.find(\"input[type='checkbox']:checked\").length) p.find(\".vote\").prop(\"disabled\", false);else p.find(\".vote\").prop(\"disabled\", true);\n}\n\n/*****************\n ** WEBPACK FOOTER\n ** ./ohranatruda.in.ua/test/templates/iview/js/scripts_es6.js\n ** module id = 0\n ** module chunks = 0\n **/\n//# sourceURL=webpack:///./ohranatruda.in.ua/test/templates/iview/js/scripts_es6.js?");

/***/ }
/******/ ]);